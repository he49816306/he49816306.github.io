{"meta":{"title":"Malroyçš„åšå®¢","subtitle":"ä¼šå½“å‡Œç»é¡¶","description":"é‡åº†ç§‘æŠ€å¤§å­¦ | è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ | è‡ªç„¶è¯­è¨€å¤„ç†","author":"Malroy","url":"http://he49816306.github.io","root":"/"},"pages":[{"title":"404","date":"2019-07-19T08:41:10.000Z","updated":"2020-06-17T09:38:04.362Z","comments":true,"path":"404.html","permalink":"http://he49816306.github.io/404.html","excerpt":"","text":""},{"title":"about","date":"2019-07-19T08:41:10.000Z","updated":"2021-01-07T06:12:11.968Z","comments":true,"path":"about/index.html","permalink":"http://he49816306.github.io/about/index.html","excerpt":"","text":"æ•™è‚²ç»å† ç¡•å£« è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯é‡åº†å¤§å­¦2019/06 - ç°åœ¨ æœ¬ç§‘ è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ | è½¯ä»¶å·¥ç¨‹é‡åº†ç§‘æŠ€å¤§å­¦2014/09 - 2019/06ç»¼åˆæ’åä¸“ä¸šç¬¬ä¸€ è·å¾—è£èª‰2019 ä¼˜ç§€æ¯•ä¸šç”Ÿä¼˜ç§€æ¯•ä¸šç”Ÿï¼ˆé‡åº†ï¼‰ ä¸€ç­‰å¥–å­¦é‡‘å¥–å­¦é‡‘ï¼ˆæ ¡çº§ï¼‰ ä¼ä¸šè£èª‰é¡¹ç›®ç»„ç‰¹åˆ«çªå‡ºå‘˜å·¥ 2018 ä¸€ç­‰å¥–å­¦é‡‘å¥–å­¦é‡‘ï¼ˆæ ¡çº§ï¼‰ å›¢ä½“ä¸€ç­‰å¥–ä¸­å›½é«˜æ ¡è®¡ç®—æœºå¤§èµ›-å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ› é«˜æ ¡ä¸€ç­‰å¥–ä¸­å›½é«˜æ ¡è®¡ç®—æœºå¤§èµ›-å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ› 2017 è£èª‰è¯ä¹¦ç§‘æŠ€åˆ›æ–°ä¼˜ç§€å­¦ç”Ÿï¼ˆæ ¡çº§ï¼‰ è£èª‰è¯ä¹¦è‡ªç«‹è‡ªå¼ºä¼˜ç§€å­¦ç”Ÿï¼ˆæ ¡çº§ï¼‰ é“œç‰Œå¤§å­¦ç”Ÿå¾®ä¿¡å°ç¨‹åºå¤§èµ›ï¼ˆç¬¬ä¸€å±Šï¼‰ ä¸€ç­‰å¥–å­¦é‡‘å¥–å­¦é‡‘ï¼ˆæ ¡çº§ï¼‰ 2016 å›½å®¶å¥–å­¦é‡‘å¥–å­¦é‡‘ï¼ˆå›½å®¶çº§ï¼‰ é“œç‰Œå¤§å­¦ç”Ÿæ•°å­¦å»ºæ¨¡å¤§èµ›ï¼ˆé‡åº†ï¼‰ è”ç³»æ–¹å¼ ç”µå­é‚®ç®±62614929@qq.com åœ°å€é‡åº†å¸‚æ²™åªå QQ æŠ€æœ¯äº¤æµç¾¤520520520"},{"title":"archives","date":"2019-07-19T08:39:20.000Z","updated":"2020-06-17T09:38:04.364Z","comments":true,"path":"archives/index.html","permalink":"http://he49816306.github.io/archives/index.html","excerpt":"","text":""},{"title":"categories","date":"2019-07-19T08:39:20.000Z","updated":"2020-06-17T09:38:04.365Z","comments":true,"path":"categories/index.html","permalink":"http://he49816306.github.io/categories/index.html","excerpt":"","text":""},{"title":"contact","date":"2019-07-26T09:17:02.000Z","updated":"2020-06-18T09:16:51.437Z","comments":true,"path":"contact/index.html","permalink":"http://he49816306.github.io/contact/index.html","excerpt":"","text":"æ¬¢è¿ç•™è¨€å¤§å®¶æœ‰ä»»ä½•é—®é¢˜ï¼Œéƒ½å¯ä»¥åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€ï¼Œæˆ–è€…åŠ  QQ æŠ€æœ¯äº¤æµç¾¤ã€ç¾¤å·ï¼š520520520ã€‘ã€‚ æˆ‘å¾ˆå¿™å•¦ï¼Œå¦‚æœä¸æ˜¯å¾ˆéº»çƒ¦çš„é—®é¢˜å°±ç›´æ¥åœ¨è¯„è®ºåŒºç•™è¨€å•¦ã€‚ å‹é“¾äº¤æ¢æƒ³è¦äº¤æ¢å‹é“¾çš„å°ä¼™ä¼´ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œç•™è¨€æ ¼å¼ï¼š åç§°ï¼šä½ çš„åšå®¢åç§° åœ°å€ï¼šä½ çš„åšå®¢åœ°å€ ç®€ä»‹ï¼šä¸€å¥è¯ç®€ä»‹ å¤´åƒï¼šä½ çš„å¤´åƒåœ°å€"},{"title":"tags","date":"2019-07-19T08:40:27.000Z","updated":"2020-06-17T09:38:04.366Z","comments":true,"path":"tags/index.html","permalink":"http://he49816306.github.io/tags/index.html","excerpt":"","text":""},{"title":"friends","date":"2019-07-19T08:42:10.000Z","updated":"2020-06-18T09:17:06.050Z","comments":true,"path":"friends/index.html","permalink":"http://he49816306.github.io/friends/index.html","excerpt":"","text":"å‹é“¾äº¤æ¢æƒ³è¦äº¤æ¢å‹é“¾çš„å°ä¼™ä¼´ï¼Œæ¬¢è¿åœ¨ç•™è¨€æ¿ç•™è¨€ï¼Œç•™è¨€æ ¼å¼ï¼š åç§°ï¼šä½ çš„åšå®¢åç§° åœ°å€ï¼šä½ çš„åšå®¢åœ°å€ ç®€ä»‹ï¼šä¸€å¥è¯ç®€ä»‹ å¤´åƒï¼šä½ çš„å¤´åƒåœ°å€"}],"posts":[{"title":"Redisåˆ†å¸ƒå¼é”","slug":"Redisåˆ†å¸ƒå¼é”","date":"2021-01-04T06:21:47.000Z","updated":"2021-01-07T06:22:56.169Z","comments":true,"path":"2021/01/04/Redisåˆ†å¸ƒå¼é”/","link":"","permalink":"http://he49816306.github.io/2021/01/04/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/","excerpt":"","text":"ä¸€ã€ä¸šåŠ¡èƒŒæ™¯æœ‰äº›ä¸šåŠ¡è¯·æ±‚ï¼Œå±äºè€—æ—¶æ“ä½œï¼Œéœ€è¦åŠ é”ï¼Œé˜²æ­¢åç»­çš„å¹¶å‘æ“ä½œï¼ŒåŒæ—¶å¯¹æ•°æ®åº“çš„æ•°æ®è¿›è¡Œæ“ä½œï¼Œéœ€è¦é¿å…å¯¹ä¹‹å‰çš„ä¸šåŠ¡é€ æˆå½±å“ã€‚ äºŒã€åˆ†ææµç¨‹ä½¿ç”¨ Redis ä½œä¸ºåˆ†å¸ƒå¼é”ï¼Œå°†é”çš„çŠ¶æ€æ”¾åˆ° Redis ç»Ÿä¸€ç»´æŠ¤ï¼Œè§£å†³é›†ç¾¤ä¸­å•æœº JVM ä¿¡æ¯ä¸äº’é€šçš„é—®é¢˜ï¼Œè§„å®šæ“ä½œé¡ºåºï¼Œä¿æŠ¤ç”¨æˆ·çš„æ•°æ®æ­£ç¡®ã€‚ æ¢³ç†è®¾è®¡æµç¨‹ æ–°å»ºæ³¨è§£ @interfaceï¼Œåœ¨æ³¨è§£é‡Œè®¾å®šå…¥å‚æ ‡å¿— å¢åŠ  AOP åˆ‡ç‚¹ï¼Œæ‰«æç‰¹å®šæ³¨è§£ å»ºç«‹ @Aspect åˆ‡é¢ä»»åŠ¡ï¼Œæ³¨å†Œ bean å’Œæ‹¦æˆªç‰¹å®šæ–¹æ³• ç‰¹å®šæ–¹æ³•å‚æ•° ProceedingJoinPointï¼Œå¯¹æ–¹æ³• pjp.proceed() å‰åè¿›è¡Œæ‹¦æˆª åˆ‡ç‚¹å‰è¿›è¡ŒåŠ é”ï¼Œä»»åŠ¡æ‰§è¡Œåè¿›è¡Œåˆ é™¤ key æ ¸å¿ƒæ­¥éª¤ï¼šåŠ é”ã€è§£é”å’Œç»­æ—¶ åŠ é”ä½¿ç”¨äº† RedisTemplate çš„ opsForValue.setIfAbsent æ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ keyï¼Œè®¾å®šä¸€ä¸ªéšæœºæ•° UUID.random().toStringï¼Œç”Ÿæˆä¸€ä¸ªéšæœºæ•°ä½œä¸º valueã€‚ ä» redis ä¸­è·å–é”ä¹‹åï¼Œå¯¹ key è®¾å®š expire å¤±æ•ˆæ—¶é—´ï¼Œåˆ°æœŸåè‡ªåŠ¨é‡Šæ”¾é”ã€‚ æŒ‰ç…§è¿™ç§è®¾è®¡ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªæˆåŠŸè®¾å®š Key çš„è¯·æ±‚ï¼Œæ‰èƒ½è¿›è¡Œåç»­çš„æ•°æ®æ“ä½œï¼Œåç»­å…¶å®ƒè¯·æ±‚ç”±äºæ— æ³•è·å¾—ğŸ”èµ„æºï¼Œå°†ä¼šå¤±è´¥ç»“æŸã€‚ è¶…æ—¶é—®é¢˜æ‹…å¿ƒ pjp.proceed() åˆ‡ç‚¹æ‰§è¡Œçš„æ–¹æ³•å¤ªè€—æ—¶ï¼Œå¯¼è‡´ Redis ä¸­çš„ key ç”±äºè¶…æ—¶æå‰é‡Šæ”¾äº†ã€‚ ä¾‹å¦‚ï¼Œçº¿ç¨‹ A å…ˆè·å–é”ï¼Œproceed æ–¹æ³•è€—æ—¶ï¼Œè¶…è¿‡äº†é”è¶…æ—¶æ—¶é—´ï¼Œåˆ°æœŸé‡Šæ”¾äº†é”ï¼Œè¿™æ—¶å¦ä¸€ä¸ªçº¿ç¨‹ B æˆåŠŸè·å– Redis é”ï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹åŒä¸€æ‰¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ã€‚ è§£å†³æ–¹æ¡ˆï¼šå¢åŠ ä¸€ä¸ªã€Œç»­æ—¶ã€ä»»åŠ¡ä¸å®Œæˆï¼Œé”ä¸é‡Šæ”¾ï¼š ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶çº¿ç¨‹æ±  ScheduledExecutorServiceï¼Œæ¯éš” 2s å»æ‰«æåŠ å…¥é˜Ÿåˆ—ä¸­çš„ Taskï¼Œåˆ¤æ–­æ˜¯å¦å¤±æ•ˆæ—¶é—´æ˜¯å¦å¿«åˆ°äº†ï¼Œå…¬å¼ä¸ºï¼šã€å¤±æ•ˆæ—¶é—´ã€‘&lt;= ã€å½“å‰æ—¶é—´ã€‘+ã€å¤±æ•ˆé—´éš”ï¼ˆä¸‰åˆ†ä¹‹ä¸€è¶…æ—¶ï¼‰ã€‘ /** * çº¿ç¨‹æ± ï¼Œæ¯ä¸ª JVM ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å»ç»´æŠ¤ keyAliveTimeï¼Œå®šæ—¶æ‰§è¡Œ runnable */ private static final ScheduledExecutorService SCHEDULER = new ScheduledThreadPoolExecutor(1, new BasicThreadFactory.Builder().namingPattern(&quot;redisLock-schedule-pool&quot;).daemon(true).build()); static { SCHEDULER.scheduleAtFixedRate(() -&gt; { // do something to extend time }, 0, 2, TimeUnit.SECONDS); } ä¸‰ã€è®¾è®¡æ–¹æ¡ˆç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œå°ä½•è®¾è®¡å‡ºäº†è¿™ä¸ªæ–¹æ¡ˆï¼š å‰é¢å·²ç»è¯´äº†æ•´ä½“æµç¨‹ï¼Œè¿™é‡Œå¼ºè°ƒä¸€ä¸‹å‡ ä¸ªæ ¸å¿ƒæ­¥éª¤ï¼š æ‹¦æˆªæ³¨è§£ @RedisLockï¼Œè·å–å¿…è¦çš„å‚æ•° åŠ é”æ“ä½œ ç»­æ—¶æ“ä½œ ç»“æŸä¸šåŠ¡ï¼Œé‡Šæ”¾é” å››ã€å®æ“ä¹‹å‰ä¹Ÿæœ‰æ•´ç†è¿‡ AOP ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ ç›¸å…³å±æ€§ç±»é…ç½®ä¸šåŠ¡å±æ€§æšä¸¾è®¾å®špublic enum RedisLockTypeEnum { /** * è‡ªå®šä¹‰ key å‰ç¼€ */ ONE(&quot;Business1&quot;, &quot;Test1&quot;), TWO(&quot;Business2&quot;, &quot;Test2&quot;); private String code; private String desc; RedisLockTypeEnum(String code, String desc) { this.code = code; this.desc = desc; } public String getCode() { return code; } public String getDesc() { return desc; } public String getUniqueKey(String key) { return String.format(&quot;%s:%s&quot;, this.getCode(), key); } }ä»»åŠ¡é˜Ÿåˆ—ä¿å­˜å‚æ•° public class RedisLockDefinitionHolder { /** * ä¸šåŠ¡å”¯ä¸€ key */ private String businessKey; /** * åŠ é”æ—¶é—´ (ç§’ s) */ private Long lockTime; /** * ä¸Šæ¬¡æ›´æ–°æ—¶é—´ï¼ˆmsï¼‰ */ private Long lastModifyTime; /** * ä¿å­˜å½“å‰çº¿ç¨‹ */ private Thread currentTread; /** * æ€»å…±å°è¯•æ¬¡æ•° */ private int tryCount; /** * å½“å‰å°è¯•æ¬¡æ•° */ private int currentCount; /** * æ›´æ–°çš„æ—¶é—´å‘¨æœŸï¼ˆæ¯«ç§’ï¼‰,å…¬å¼ = åŠ é”æ—¶é—´ï¼ˆè½¬æˆæ¯«ç§’ï¼‰ / 3 */ private Long modifyPeriod; public RedisLockDefinitionHolder(String businessKey, Long lockTime, Long lastModifyTime, Thread currentTread, int tryCount) { this.businessKey = businessKey; this.lockTime = lockTime; this.lastModifyTime = lastModifyTime; this.currentTread = currentTread; this.tryCount = tryCount; this.modifyPeriod = lockTime * 1000 / 3; } }è®¾å®šè¢«æ‹¦æˆªçš„æ³¨è§£åå­—@Retention(RetentionPolicy.RUNTIME) @Target({ElementType.METHOD, ElementType.TYPE}) public @interface RedisLockAnnotation { /** * ç‰¹å®šå‚æ•°è¯†åˆ«ï¼Œé»˜è®¤å–ç¬¬ 0 ä¸ªä¸‹æ ‡ */ int lockFiled() default 0; /** * è¶…æ—¶é‡è¯•æ¬¡æ•° */ int tryCount() default 3; /** * è‡ªå®šä¹‰åŠ é”ç±»å‹ */ RedisLockTypeEnum typeEnum(); /** * é‡Šæ”¾æ—¶é—´ï¼Œç§’ s å•ä½ */ long lockTime() default 30; }æ ¸å¿ƒåˆ‡é¢æ‹¦æˆªçš„æ“ä½œRedisLockAspect.java è¯¥ç±»åˆ†æˆä¸‰éƒ¨åˆ†æ¥æè¿°å…·ä½“ä½œç”¨ Pointcut è®¾å®š/** * @annotation ä¸­çš„è·¯å¾„è¡¨ç¤ºæ‹¦æˆªç‰¹å®šæ³¨è§£ */ @Pointcut(&quot;@annotation(cn.sevenyuan.demo.aop.lock.RedisLockAnnotation)&quot;) public void redisLockPC() { }Around å‰åè¿›è¡ŒåŠ é”å’Œé‡Šæ”¾é”å‰é¢æ­¥éª¤å®šä¹‰äº†æˆ‘ä»¬æƒ³è¦æ‹¦æˆªçš„åˆ‡ç‚¹ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯åœ¨åˆ‡ç‚¹å‰ååšä¸€äº›è‡ªå®šä¹‰æ“ä½œï¼š @Around(value = &quot;redisLockPC()&quot;) public Object around(ProceedingJoinPoint pjp) throws Throwable { // è§£æå‚æ•° Method method = resolveMethod(pjp); RedisLockAnnotation annotation = method.getAnnotation(RedisLockAnnotation.class); RedisLockTypeEnum typeEnum = annotation.typeEnum(); Object[] params = pjp.getArgs(); String ukString = params[annotation.lockFiled()].toString(); // çœç•¥å¾ˆå¤šå‚æ•°æ ¡éªŒå’Œåˆ¤ç©º String businessKey = typeEnum.getUniqueKey(ukString); String uniqueValue = UUID.randomUUID().toString(); // åŠ é” Object result = null; try { boolean isSuccess = redisTemplate.opsForValue().setIfAbsent(businessKey, uniqueValue); if (!isSuccess) { throw new Exception(&quot;You can&#39;t do itï¼Œbecause another has get the lock =-=&quot;); } redisTemplate.expire(businessKey, annotation.lockTime(), TimeUnit.SECONDS); Thread currentThread = Thread.currentThread(); // å°†æœ¬æ¬¡ Task ä¿¡æ¯åŠ å…¥ã€Œå»¶æ—¶ã€é˜Ÿåˆ—ä¸­ holderList.add(new RedisLockDefinitionHolder(businessKey, annotation.lockTime(), System.currentTimeMillis(), currentThread, annotation.tryCount())); // æ‰§è¡Œä¸šåŠ¡æ“ä½œ result = pjp.proceed(); // çº¿ç¨‹è¢«ä¸­æ–­ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œä¸­æ–­æ­¤æ¬¡è¯·æ±‚ if (currentThread.isInterrupted()) { throw new InterruptedException(&quot;You had been interrupted =-=&quot;); } } catch (InterruptedException e ) { log.error(&quot;Interrupt exception, rollback transaction&quot;, e); throw new Exception(&quot;Interrupt exception, please send request again&quot;); } catch (Exception e) { log.error(&quot;has some error, please check again&quot;, e); } finally { // è¯·æ±‚ç»“æŸåï¼Œå¼ºåˆ¶åˆ æ‰ keyï¼Œé‡Šæ”¾é” redisTemplate.delete(businessKey); log.info(&quot;release the lock, businessKey is [&quot; + businessKey + &quot;]&quot;); } return result; }ä¸Šè¿°æµç¨‹ç®€å•æ€»ç»“ä¸€ä¸‹ï¼š è§£ææ³¨è§£å‚æ•°ï¼Œè·å–æ³¨è§£å€¼å’Œæ–¹æ³•ä¸Šçš„å‚æ•°å€¼ redis åŠ é”å¹¶ä¸”è®¾ç½®è¶…æ—¶æ—¶é—´ å°†æœ¬æ¬¡ Task ä¿¡æ¯åŠ å…¥ã€Œå»¶æ—¶ã€é˜Ÿåˆ—ä¸­ï¼Œè¿›è¡Œç»­æ—¶ï¼Œæ–¹å¼æå‰é‡Šæ”¾é” åŠ äº†ä¸€ä¸ªçº¿ç¨‹ä¸­æ–­æ ‡å¿— ç»“æŸè¯·æ±‚ï¼Œfinally ä¸­é‡Šæ”¾é” ç»­æ—¶æ“ä½œè¿™é‡Œç”¨äº† ScheduledExecutorServiceï¼Œç»´æŠ¤äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸æ–­å¯¹ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¿›è¡Œåˆ¤æ–­å’Œå»¶é•¿è¶…æ—¶æ—¶é—´ï¼š // æ‰«æçš„ä»»åŠ¡é˜Ÿåˆ— private static ConcurrentLinkedQueue&lt;RedisLockDefinitionHolder&gt; holderList = new ConcurrentLinkedQueue(); /** * çº¿ç¨‹æ± ï¼Œç»´æŠ¤keyAliveTime */ private static final ScheduledExecutorService SCHEDULER = new ScheduledThreadPoolExecutor(1, new BasicThreadFactory.Builder().namingPattern(&quot;redisLock-schedule-pool&quot;).daemon(true).build()); { // ä¸¤ç§’æ‰§è¡Œä¸€æ¬¡ã€Œç»­æ—¶ã€æ“ä½œ SCHEDULER.scheduleAtFixedRate(() -&gt; { // è¿™é‡Œè®°å¾—åŠ  try-catchï¼Œå¦è€…æŠ¥é”™åå®šæ—¶ä»»åŠ¡å°†ä¸ä¼šå†æ‰§è¡Œ=-= Iterator&lt;RedisLockDefinitionHolder&gt; iterator = holderList.iterator(); while (iterator.hasNext()) { RedisLockDefinitionHolder holder = iterator.next(); // åˆ¤ç©º if (holder == null) { iterator.remove(); continue; } // åˆ¤æ–­ key æ˜¯å¦è¿˜æœ‰æ•ˆï¼Œæ— æ•ˆçš„è¯è¿›è¡Œç§»é™¤ if (redisTemplate.opsForValue().get(holder.getBusinessKey()) == null) { iterator.remove(); continue; } // è¶…æ—¶é‡è¯•æ¬¡æ•°ï¼Œè¶…è¿‡æ—¶ç»™çº¿ç¨‹è®¾å®šä¸­æ–­ if (holder.getCurrentCount() &gt; holder.getTryCount()) { holder.getCurrentTread().interrupt(); iterator.remove(); continue; } // åˆ¤æ–­æ˜¯å¦è¿›å…¥æœ€åä¸‰åˆ†ä¹‹ä¸€æ—¶é—´ long curTime = System.currentTimeMillis(); boolean shouldExtend = (holder.getLastModifyTime() + holder.getModifyPeriod()) &lt;= curTime; if (shouldExtend) { holder.setLastModifyTime(curTime); redisTemplate.expire(holder.getBusinessKey(), holder.getLockTime(), TimeUnit.SECONDS); log.info(&quot;businessKey : [&quot; + holder.getBusinessKey() + &quot;], try count : &quot; + holder.getCurrentCount()); holder.setCurrentCount(holder.getCurrentCount() + 1); } } }, 0, 2, TimeUnit.SECONDS); }è¿™æ®µä»£ç ï¼Œç”¨æ¥å®ç°è®¾è®¡å›¾ä¸­è™šçº¿æ¡†çš„æ€æƒ³ï¼Œé¿å…ä¸€ä¸ªè¯·æ±‚ååˆ†è€—æ—¶ï¼Œå¯¼è‡´æå‰é‡Šæ”¾äº†é”ã€‚ è¿™é‡ŒåŠ äº†ã€Œçº¿ç¨‹ä¸­æ–­ã€Thread#interruptï¼Œå¸Œæœ›è¶…è¿‡é‡è¯•æ¬¡æ•°åï¼Œèƒ½è®©çº¿ç¨‹ä¸­æ–­ï¼ˆæœªç»ä¸¥è°¨æµ‹è¯•ï¼Œä»…ä¾›å‚è€ƒå“ˆå“ˆå“ˆå“ˆï¼‰ ä¸è¿‡å»ºè®®å¦‚æœé‡åˆ°è¿™ä¹ˆè€—æ—¶çš„è¯·æ±‚ï¼Œè¿˜æ˜¯èƒ½å¤Ÿä»æ ¹æºä¸ŠæŸ¥æ‰¾ï¼Œåˆ†æè€—æ—¶è·¯å¾„ï¼Œè¿›è¡Œä¸šåŠ¡ä¼˜åŒ–æˆ–å…¶å®ƒå¤„ç†ï¼Œé¿å…è¿™äº›è€—æ—¶æ“ä½œã€‚ æ‰€ä»¥è®°å¾—å¤šæ‰“ç‚¹ Logï¼Œåˆ†æé—®é¢˜æ—¶å¯ä»¥æ›´å¿«ä¸€ç‚¹ã€‚å¦‚ä½•ä½¿ç”¨SpringBoot AOP è®°å½•æ“ä½œæ—¥å¿—ã€å¼‚å¸¸æ—¥å¿—ï¼Ÿ äº”ã€å¼€å§‹æµ‹è¯•åœ¨ä¸€ä¸ªå…¥å£æ–¹æ³•ä¸­ï¼Œä½¿ç”¨è¯¥æ³¨è§£ï¼Œç„¶ååœ¨ä¸šåŠ¡ä¸­æ¨¡æ‹Ÿè€—æ—¶è¯·æ±‚ï¼Œä½¿ç”¨äº† Thread#sleep @GetMapping(&quot;/testRedisLock&quot;) @RedisLockAnnotation(typeEnum = RedisLockTypeEnum.ONE, lockTime = 3) public Book testRedisLock(@RequestParam(&quot;userId&quot;) Long userId) { try { log.info(&quot;ç¡çœ æ‰§è¡Œå‰&quot;); Thread.sleep(10000); log.info(&quot;ç¡çœ æ‰§è¡Œå&quot;); } catch (Exception e) { // log error log.info(&quot;has some error&quot;, e); } return null; }ä½¿ç”¨æ—¶ï¼Œåœ¨æ–¹æ³•ä¸Šæ·»åŠ è¯¥æ³¨è§£ï¼Œç„¶åè®¾å®šç›¸åº”å‚æ•°å³å¯ï¼Œæ ¹æ® typeEnum å¯ä»¥åŒºåˆ†å¤šç§ä¸šåŠ¡ï¼Œé™åˆ¶è¯¥ä¸šåŠ¡è¢«åŒæ—¶æ“ä½œã€‚ æµ‹è¯•ç»“æœï¼š 2021-01-04 14:55:50.864 INFO 9326 --- [nio-8081-exec-1] c.s.demo.controller.BookController : ç¡çœ æ‰§è¡Œå‰ 2021-01-04 14:55:52.855 INFO 9326 --- [k-schedule-pool] c.s.demo.aop.lock.RedisLockAspect : businessKey : [Business1:1024], try count : 0 2021-01-04 14:55:54.851 INFO 9326 --- [k-schedule-pool] c.s.demo.aop.lock.RedisLockAspect : businessKey : [Business1:1024], try count : 1 2021-01-04 14:55:56.851 INFO 9326 --- [k-schedule-pool] c.s.demo.aop.lock.RedisLockAspect : businessKey : [Business1:1024], try count : 2 2021-01-04 14:55:58.852 INFO 9326 --- [k-schedule-pool] c.s.demo.aop.lock.RedisLockAspect : businessKey : [Business1:1024], try count : 3 2021-01-04 14:56:00.857 INFO 9326 --- [nio-8081-exec-1] c.s.demo.controller.BookController : has some error java.lang.InterruptedException: sleep interrupted at java.lang.Thread.sleep(Native Method) [na:1.8.0_221]æˆ‘è¿™é‡Œæµ‹è¯•çš„æ˜¯é‡è¯•æ¬¡æ•°è¿‡å¤šï¼Œå¤±è´¥çš„åœºæ™¯ï¼Œå¦‚æœå‡å°‘ç¡çœ æ—¶é—´ï¼Œå°±èƒ½è®©ä¸šåŠ¡æ­£å¸¸æ‰§è¡Œã€‚ å¦‚æœåŒæ—¶è¯·æ±‚ï¼Œä½ å°†ä¼šå‘ç°ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š 2021-01-04 14:58:00.857 INFO 9326 --- [nio-8081-exec-9] c.s.demo.aop.lock.RedisLockAspect : has some error,please check again java.lang.Exception: You can&#39;t do it,because another has get the lock =-=è¡¨ç¤ºæˆ‘ä»¬çš„é”ğŸ”çš„ç¡®ç”Ÿæ•ˆäº†ï¼Œé¿å…äº†é‡å¤è¯·æ±‚ã€‚ å…­ã€æ€»ç»“å¯¹äºè€—æ—¶ä¸šåŠ¡å’Œæ ¸å¿ƒæ•°æ®ï¼Œä¸èƒ½è®©é‡å¤çš„è¯·æ±‚åŒæ—¶æ“ä½œæ•°æ®ï¼Œé¿å…æ•°æ®çš„ä¸æ­£ç¡®ï¼Œæ‰€ä»¥è¦ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥å¯¹å®ƒä»¬è¿›è¡Œä¿æŠ¤ã€‚ å†æ¥æ¢³ç†ä¸€ä¸‹è®¾è®¡æµç¨‹ï¼š æ–°å»ºæ³¨è§£ @interfaceï¼Œåœ¨æ³¨è§£é‡Œè®¾å®šå…¥å‚æ ‡å¿— å¢åŠ  AOP åˆ‡ç‚¹ï¼Œæ‰«æç‰¹å®šæ³¨è§£ å»ºç«‹ @Aspect åˆ‡é¢ä»»åŠ¡ï¼Œæ³¨å†Œ bean å’Œæ‹¦æˆªç‰¹å®šæ–¹æ³• ç‰¹å®šæ–¹æ³•å‚æ•° ProceedingJoinPointï¼Œå¯¹æ–¹æ³• pjp.proceed() å‰åè¿›è¡Œæ‹¦æˆª åˆ‡ç‚¹å‰è¿›è¡ŒåŠ é”ï¼Œä»»åŠ¡æ‰§è¡Œåè¿›è¡Œåˆ é™¤ key æœ¬æ¬¡å­¦ä¹ æ˜¯é€šè¿‡ æµ‹è¯•å°å§å§ å¯¹æ“ä½œè¿›è¡Œå¹¶å‘æµ‹è¯•ï¼Œä»ä¸­å¼•ç”³å‡ºåˆ†å¸ƒå¼é”çš„æ¦‚å¿µå’Œå…·ä½“å®ç°ï¼Œç„¶åå†™äº†ä¸€ä»½ç®€åŒ–ç‰ˆçš„ä¸šåŠ¡å¤„ç†ã€‚å¯¹äºä¹‹å‰æ²¡è€ƒè™‘åˆ°çš„ã€Œç»­æ—¶ã€æ“ä½œï¼Œè¿™é‡Œä½¿ç”¨äº†å®ˆæŠ¤çº¿ç¨‹æ¥å®šæ—¶åˆ¤æ–­å’Œå»¶é•¿è¶…æ—¶æ—¶é—´ï¼Œé¿å…äº†é”æå‰é‡Šæ”¾ã€‚ äºæ˜¯ä¹ï¼ŒåŒæ—¶å›é¡¾äº†ä¸‰ä¸ªçŸ¥è¯†ç‚¹ï¼š 1ã€AOP çš„å®ç°å’Œå¸¸ç”¨æ–¹æ³• 2ã€å®šæ—¶çº¿ç¨‹æ±  ScheduledExecutorService çš„ä½¿ç”¨å’Œå‚æ•°å«ä¹‰ 3ã€çº¿ç¨‹ Thread#interrupt çš„å«ä¹‰ä»¥åŠç”¨æ³•ï¼ˆè¿™ä¸ªæŒºæœ‰æ„æ€çš„ï¼Œå¯ä»¥æ·±å…¥å†å­¦ä¹ ä¸€ä¸‹ï¼‰ å…·ä½“ä»£ç æ”¾åœ¨äº†ä¹‹å‰å­¦ä¹  SpringBoot çš„é¡¹ç›®ä¸­ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å…‹éš†ä¸€ä¸‹ï¼Œä½¿ç”¨è¿™ä¸ª Redis ğŸ”","categories":[{"name":"å¹¶å‘æ“ä½œ","slug":"å¹¶å‘æ“ä½œ","permalink":"http://he49816306.github.io/categories/%E5%B9%B6%E5%8F%91%E6%93%8D%E4%BD%9C/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"http://he49816306.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"},{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"http://he49816306.github.io/tags/%E4%BC%98%E5%8C%96/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","permalink":"http://he49816306.github.io/tags/%E5%B9%B6%E5%8F%91/"}]},{"title":"FutureTaskæºç ","slug":"FutureTaskæºç ","date":"2020-06-19T07:17:46.000Z","updated":"2020-06-19T07:24:36.885Z","comments":true,"path":"2020/06/19/FutureTaskæºç /","link":"","permalink":"http://he49816306.github.io/2020/06/19/FutureTask%E6%BA%90%E7%A0%81/","excerpt":"","text":"FutureTaskæºç ç®€ä»‹å®ç°äº†Futureã€Runnableæ¥å£ï¼Œå¯ä»¥çœ‹æˆä¸€ä¸ªå¸¦æ‰§è¡Œç»“æœçš„çº¿ç¨‹ä»»åŠ¡ï¼›ä»£ç å¾ˆç®€å•ï¼Œå°±ä¸è¯´å¤ªå¤šäº†ï¼Œæœ‰äº›åŸºç¡€è¯·ç§ä¸‹é—®æˆ‘ï¼Œæˆ–è€…æ‰¾åº¦å¨˜ æˆå‘˜å˜é‡ private volatile int state; private static final int NEW = 0; private static final int COMPLETING = 1; private static final int NORMAL = 2; private static final int EXCEPTIONAL = 3; private static final int CANCELLED = 4; private static final int INTERRUPTING = 5; private static final int INTERRUPTED = 6; private Callable&lt;V&gt; callable; private Object outcome; private volatile Thread runner; private volatile WaitNode waiters; private static final sun.misc.Unsafe U = sun.misc.Unsafe.getUnsafe(); private static final long STATE; private static final long RUNNER; private static final long WAITERS; static { try { STATE = U.objectFieldOffset (FutureTask.class.getDeclaredField(&quot;state&quot;)); RUNNER = U.objectFieldOffset (FutureTask.class.getDeclaredField(&quot;runner&quot;)); WAITERS = U.objectFieldOffset (FutureTask.class.getDeclaredField(&quot;waiters&quot;)); } catch (ReflectiveOperationException e) { throw new Error(e); } Class&lt;?&gt; ensureLoaded = LockSupport.class; }å…³é”®ä¿¡æ¯è§£è¯» stateï¼Œwaitersï¼Œ runneréƒ½å¯ä»¥åšåŸå­æ“ä½œï¼ˆUnsafeç±»ï¼‰ state æœ‰7ç§çŠ¶æ€ï¼Œ0 å¯æ‰§è¡Œæ€ï¼Œ1æ˜¯æ‰§è¡Œå®Œæ¯•æ€ï¼Œ2æ˜¯å¯ä»¥è·å–ç»“æœçŠ¶æ€ï¼Œ3æ˜¯æ‰§è¡Œå‡ºç°å¼‚å¸¸ï¼Œ4,5æ˜¯æœªæ‰§è¡Œå–æ¶ˆçŠ¶æ€ï¼Œ6æ˜¯æ‰§è¡Œè¿‡ç¨‹ä¸­å–æ¶ˆçŠ¶æ€ callable å…·ä½“æ‰§è¡ŒåŠ¨ä½œ outcome æ‰§è¡Œç»“æœ runner åŠ¨ä½œæ‰§è¡Œæ‰€åœ¨çº¿ç¨‹ waiters å•å‘é“¾è¡¨ï¼Œè¡¨å¤´ï¼Œå†…éƒ¨å«æœ‰çº¿ç¨‹ä¿¡æ¯ï¼›è¡¨ç¤ºè·å–ç»“æœçš„æŒ‚èµ·çº¿ç¨‹é˜Ÿåˆ— æˆå‘˜æ–¹æ³•æ„é€ æ–¹æ³•å¯ä»¥æ‰§è¡Œcallbleæˆ–è€…runnableå¯¹è±¡ï¼Œrunnableå¯¹è±¡ä½¿ç”¨é€‚é…å™¨çš„æ–¹å¼ï¼Œæ˜¯é…æˆæ–°çš„callbleå¯¹è±¡ï¼Œå¹¶ä¸”ä¼ å…¥çš„resultä¸ºç»“æœï¼›å¹¶ç¡®å®šå½“å‰çŠ¶æ€ä¸ºnewï¼Œå¯æ‰§è¡ŒçŠ¶æ€ public FutureTask(Callable&lt;V&gt; callable) { if (callable == null) throw new NullPointerException(); this.callable = callable; this.state = NEW; } public FutureTask(Runnable runnable, V result) { this.callable = Executors.callable(runnable, result); this.state = NEW; }reportæ–¹æ³•å¦‚æœæ­£å¸¸æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™è¿”å›æ‰§è¡Œç»“æœï¼Œå¦åˆ™ï¼Œæ ¹æ®çŠ¶æ€æŠ›å‡ºå¼‚å¸¸ private V report(int s) throws ExecutionException { Object x = outcome; if (s == NORMAL) return (V)x; if (s &gt;= CANCELLED) throw new CancellationException(); throw new ExecutionException((Throwable)x); }çŠ¶æ€åˆ¤æ–­æ ¹æ®stateå¯¹çŠ¶æ€è¿›è¡Œåˆ¤æ–­ public boolean isCancelled() { return state &gt;= CANCELLED; } public boolean isDone() { return state != NEW; }cancelä»»åŠ¡ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆä»»åŠ¡ï¼Œæ ¹æ®ç”¨æˆ·æ˜¯å¦å¯æ‰“æ–­ã€ä»»åŠ¡æ˜¯å¦æ‰§è¡Œï¼Œæ¥æ”¹å˜çŠ¶æ€ 4,5,6 public boolean cancel(boolean mayInterruptIfRunning) { if (!(state == NEW &amp;&amp; U.compareAndSwapInt(this, STATE, NEW, mayInterruptIfRunning ? INTERRUPTING : CANCELLED))) return false; try { // in case call to interrupt throws exception if (mayInterruptIfRunning) { try { Thread t = runner; if (t != null) t.interrupt(); } finally { // final state U.putOrderedInt(this, STATE, INTERRUPTED); } } } finally { finishCompletion(); } return true; }getè·å–æ‰§è¡Œç»“æœè·å–ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œæœ€å¤šç­‰å¾…æ—¶é—´æ¨¡å¼ï¼Œå’Œæ— çº¿ç­‰å¾…æ—¶é—´æ¨¡å¼ public V get() throws InterruptedException, ExecutionException { int s = state; if (s &lt;= COMPLETING) s = awaitDone(false, 0L); return report(s); } /** * @throws CancellationException {@inheritDoc} */ public V get(long timeout, TimeUnit unit) throws InterruptedException, ExecutionException, TimeoutException { if (unit == null) throw new NullPointerException(); int s = state; if (s &lt;= COMPLETING &amp;&amp; (s = awaitDone(true, unit.toNanos(timeout))) &lt;= COMPLETING) throw new TimeoutException(); return report(s); }setæ‰§è¡Œç»“æœè®¾ç½®æ‰§è¡Œç»“æœï¼Œå¦‚æœæ˜¯æ‰§è¡Œæ—¶å‡ºç°å¼‚å¸¸ï¼Œåˆ™ç»“æœä¸ºå¼‚å¸¸å¯¹è±¡ï¼Œå¦åˆ™æ‰§è¡Œç»“æœä¸ºæ­£å¸¸è¿ç®—ç»“æœï¼›å¹¶è¿›è¡ŒçŠ¶æ€ç½®æ¢ï¼Œ1æ˜¯ä¸€ä¸ªä¸´æ—¶æ€ï¼Œ2,3æ˜¯æœ€ç»ˆç»“æœæ€ protected void set(V v) { if (U.compareAndSwapInt(this, STATE, NEW, COMPLETING)) { outcome = v; U.putOrderedInt(this, STATE, NORMAL); finishCompletion(); } } protected void setException(Throwable t) { if (U.compareAndSwapInt(this, STATE, NEW, COMPLETING)) { outcome = t; U.putOrderedInt(this, STATE, EXCEPTIONAL); finishCompletion(); } }ä»»åŠ¡æ‰§è¡Œé¡¹å…·ä½“æ‰§è¡Œä»»åŠ¡åŠ¨ä½œï¼Œrunæ‰§è¡Œè¿”å›ç»“æœï¼ŒrunAndResetæ‰§è¡Œä¸å¸¦ç»“æœï¼Œå¯å†æ¬¡æ‰§è¡Œ public void run() { if (state != NEW || !U.compareAndSwapObject(this, RUNNER, null, Thread.currentThread())) return; try { Callable&lt;V&gt; c = callable; if (c != null &amp;&amp; state == NEW) { V result; boolean ran; try { result = c.call(); ran = true; } catch (Throwable ex) { result = null; ran = false; setException(ex); } if (ran) set(result); } } finally { runner = null; int s = state; if (s &gt;= INTERRUPTING) handlePossibleCancellationInterrupt(s); } } protected boolean runAndReset() { if (state != NEW || !U.compareAndSwapObject(this, RUNNER, null, Thread.currentThread())) return false; boolean ran = false; int s = state; try { Callable&lt;V&gt; c = callable; if (c != null &amp;&amp; s == NEW) { try { c.call(); // don&#39;t set result ran = true; } catch (Throwable ex) { setException(ex); } } } finally { runner = null; s = state; if (s &gt;= INTERRUPTING) handlePossibleCancellationInterrupt(s); } return ran &amp;&amp; s == NEW; } æ£€æŸ¥çŠ¶æ€æ˜¯å¦æ˜¯å¯æ‰§è¡Œï¼Œå¹¶casè®¾ç½®çº¿ç¨‹å¯¹è±¡ä»nullåˆ°å½“å‰çº¿ç¨‹ è¿›è¡Œcallableå¯¹è±¡æ‰§è¡Œï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™è®¾ç½®å¼‚å¸¸ç»“æœï¼Œæ­£å¸¸æ‰§è¡Œï¼Œè¿”å›æ­£å¸¸ç»“æœ æœ€ç»ˆè®¾ç½®çº¿ç¨‹ä¸ºç©ºï¼Œå¦‚æœçŠ¶æ€æ‰§è¡Œæ—¶çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ï¼Œå¤„ç†å¯èƒ½çš„å–æ¶ˆæ‰“æ–­æ“ä½œ finishCompletionæ–¹æ³•ç»“æŸä»»åŠ¡æ–¹æ³•ï¼Œæ‰§è¡Œç»“æŸï¼Œæ‰“æ–­ç»“æŸï¼Œå–æ¶ˆç»“æŸ waitersèŠ‚ç‚¹ç½®ç©ºï¼Œå¹¶ä¸”æ¸…é™¤é˜Ÿåˆ—ï¼Œå¹¶ä¸”å”¤é†’æ¯ä¸ªéç©ºçº¿ç¨‹èŠ‚ç‚¹ï¼Œcallableå¯¹è±¡ç½®ç©ºï¼›doneæ–¹æ³•å¯è¢«ç»§æ‰¿ï¼Œæœ¬ç±»ä¸­ä»€ä¹ˆéƒ½ä¸åš private void finishCompletion() { for (WaitNode q; (q = waiters) != null;) { if (U.compareAndSwapObject(this, WAITERS, q, null)) { for (;;) { Thread t = q.thread; if (t != null) { q.thread = null; LockSupport.unpark(t); } WaitNode next = q.next; if (next == null) break; q.next = null; q = next; } break; } } done(); callable = null; }awaitDoneæ–¹æ³•ç­‰å¾…è·å–æ‰§è¡Œç»“æœæ–¹æ³•ï¼Œä¼ å…¥å‚æ•°æœ‰ä¸¤ç§ï¼Œï¼ˆfalseï¼Œ 0ï¼‰ ï¼ˆtrueï¼Œå¤§äº0çš„æ•´æ•°å€¼ï¼‰ï¼›è‡ªæ—‹å¤„ç† private int awaitDone(boolean timed, long nanos) throws InterruptedException { long startTime = 0L; WaitNode q = null; boolean queued = false; for (;;) { int s = state; if (s &gt; COMPLETING) { if (q != null) q.thread = null; return s; } else if (s == COMPLETING) Thread.yield(); else if (Thread.interrupted()) { removeWaiter(q); throw new InterruptedException(); } else if (q == null) { if (timed &amp;&amp; nanos &lt;= 0L) return s; q = new WaitNode(); } else if (!queued) queued = U.compareAndSwapObject(this, WAITERS,q.next = waiters, q); else if (timed) { final long parkNanos; if (startTime == 0L) { startTime = System.nanoTime(); if (startTime == 0L) startTime = 1L; parkNanos = nanos; } else { long elapsed = System.nanoTime() - startTime; if (elapsed &gt;= nanos) { removeWaiter(q); return state; } parkNanos = nanos - elapsed; } if (state &lt; COMPLETING) LockSupport.parkNanos(this, parkNanos); } else LockSupport.park(this); } } è‡ªæ—‹è¿‡ç¨‹æŒ‰ç…§ä¸‹é¢ä¹¦åºæ¥æ‰§è¡Œ çŠ¶æ€åˆ¤æ–­ï¼Œæœ‰3ä¸­çŠ¶æ€åˆ¤æ–­ï¼šå·²æœ‰ç»“æœæ€ï¼Œé©¬ä¸Šæœ‰ç»“æœæ€ï¼Œè·å–ç»“æœè¢«æ‰“æ–­çŠ¶æ€ çŠ¶æ€å¤§äº1ï¼Œä¸æ˜¯æœ‰ç»“æœäº†ï¼Œå°±æ˜¯å¼‚å¸¸äº†ï¼Œå°±æ˜¯è¢«ä¸»åŠ¨å–æ¶ˆäº†ï¼Œè¿™æ—¶ç›´æ¥è¿”å›ç»“æœï¼›çŠ¶æ€ç­‰äº1è¡¨ç¤ºé©¬ä¸Šå°±åˆ°2æˆ–è€…3çŠ¶æ€ï¼Œä¸‹ä¸ªå¾ªç¯å°±æ˜¯çŠ¶æ€å¤§äº1ï¼Œç›´æ¥è¿”å›ç»“æœ å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œï¼Œä¸”è¢«æ‰“æ–­ï¼Œé‡ç½®æ‰“æ–­çŠ¶æ€ï¼Œå¹¶ä¸”å¼‚å¸¸å½“å‰çº¿ç¨‹èŠ‚ç‚¹ï¼ŒæŠ›å‡ºæ‰“æ–­å¼‚å¸¸ æ–°å»ºå½“å‰çº¿ç¨‹è·å–ç»“æœæ’é˜ŸèŠ‚ç‚¹ åŠ å…¥è·å–ç»“æœé˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”ç½®ä¸ºwaitersï¼Œä¹‹å‰waiterså€¼ä¸ºnextæŒ‡å‘èŠ‚ç‚¹ è¿›è¡Œè·å–ï¼Œæœ‰é™æ—¶é—´å†…è·å–ï¼Œæˆ–è€…æ— é™åˆ¶æ—¶é—´è·å– å¦‚æœæœ‰é™æ—¶é—´å†…è·å–ï¼Œå¦‚æœè¶…æ—¶ï¼Œè¿”å›å½“å‰çŠ¶æ€ï¼Œå¦‚æœæœªè¶…æ—¶ä¸”å½“å‰çŠ¶æ€åœ¨æ­£åœ¨æ‰§è¡ŒçŠ¶æ€ï¼Œåˆ™çº¿ç¨‹æŒ‚èµ·è®¡ç®—æ—¶é—´ ä¸é™åˆ¶æ—¶é—´è·å–ï¼Œåˆ™ç›´æ¥ç­‰å¾… removeWaiteræ–¹æ³•è‡ªæ—‹å¤„ç†ï¼Œåˆ é™¤èŠ‚ç‚¹çº¿ç¨‹å±æ€§ä¸ºç©ºçš„èŠ‚ç‚¹ private void removeWaiter(WaitNode node) { if (node != null) { node.thread = null; retry: for (;;) { // restart on removeWaiter race for (WaitNode pred = null, q = waiters, s; q != null; q = s) { s = q.next; if (q.thread != null) pred = q; else if (pred != null) { pred.next = s; if (pred.thread == null) continue retry; } else if (!U.compareAndSwapObject(this, WAITERS, q, s)) continue retry; } break; } } }å¤„ç†æ€è·¯ï¼š å¦‚æœå½“å‰ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„çº¿ç¨‹ä¸ºç©ºï¼Œåˆ™æŠŠä¸‹ä¸ªçº¿ç¨‹ç½®ä¸ºå¤´èŠ‚ç‚¹ï¼Œå¦‚æœè¿˜ç©ºç»§ç»­æ­¤è¿‡ç¨‹ï¼ŒçŸ¥é“å¤´èŠ‚ç‚¹çº¿ç¨‹ä¸ä¸ºç©ºï¼Œè¿™æ˜¯predæŒ‡å‘å¤´ï¼Œqä¸ºå¤´ä¸‹ä¸ªèŠ‚ç‚¹ï¼Œsä¸ºqä¸‹ä¸ªèŠ‚ç‚¹ å¦‚æœqçš„çº¿ç¨‹ä¸ºç©ºï¼Œåˆ™æŠŠpredçš„nextæŒ‡å‘s å¦‚æœqçš„çº¿ç¨‹ä¸ä¸ºç©ºï¼Œåˆ™ç»§ç»­ç§»åŠ¨è¿™3ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼Œç›´åˆ°qä¸ºç©ºï¼Œé€€å‡ºè‡ªæ—‹ æºç æ€»ç»“ï¼š è·å–ç»“æœä¸ºé˜»å¡è¿‡ç¨‹ï¼Œä¼šæŒ‚èµ·çº¿ç¨‹ï¼›ç­‰å¾…ç»“æœæ‰§è¡Œå®Œæ¯•ä¼šè¢«å…¨éƒ¨å”¤é†’ çº¿ç¨‹æ’é˜Ÿé˜Ÿåˆ—ä¸ºå•å‘é“¾è¡¨ï¼Œæœ‰æŒ‡å‘ä¸‹ä¸ªèŠ‚ç‚¹å±æ€§ï¼›æ¯æ¬¡æ’å…¥é“¾è¡¨å¤´éƒ¨ æ‰§è¡Œè¿‡ç¨‹ï¼Œè¿›è¡Œç»“æœå¤„ç†ï¼Œå’Œå”¤é†’é“¾è¡¨ä¸­èŠ‚ç‚¹çº¿ç¨‹ æ‰§è¡Œä¸€æ¬¡å¸¦ç»“æœåŠ¨ä½œï¼Œæˆ–è€…é‡å¤æ‰§è¡Œä¸å¸¦ç»“æœåŠ¨ä½œ","categories":[{"name":"æŠ€æœ¯åŸç†","slug":"æŠ€æœ¯åŸç†","permalink":"http://he49816306.github.io/categories/%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/"}],"tags":[{"name":"åŸç†","slug":"åŸç†","permalink":"http://he49816306.github.io/tags/%E5%8E%9F%E7%90%86/"},{"name":"æºç ","slug":"æºç ","permalink":"http://he49816306.github.io/tags/%E6%BA%90%E7%A0%81/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"http://he49816306.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"}]},{"title":"å¤§è¯CYçš„é‚£äº›æ—¥å­","slug":"å¤§è¯CYçš„é‚£äº›æ—¥å­","date":"2020-06-19T06:21:47.000Z","updated":"2021-01-07T08:21:57.078Z","comments":true,"path":"2020/06/19/å¤§è¯CYçš„é‚£äº›æ—¥å­/","link":"","permalink":"http://he49816306.github.io/2020/06/19/%E5%A4%A7%E8%AF%9DCY%E7%9A%84%E9%82%A3%E4%BA%9B%E6%97%A5%E5%AD%90/","excerpt":"","text":"è°ˆè°ˆCYçš„æ—¥å­å…¶å®è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„æ‹‰ã€‚åªæ˜¯ç°åœ¨çœ‹åˆ°é˜¿å–µæ›´å¼€å¿ƒ~~ PSï¼šä¸è¿‡é˜¿å–µ è™½ç„¶è¢«é¸¡å“¥å“¥å‘æ‰äº†ï¼Œä½†æ˜¯åé¢è¿˜æ˜¯å»äº†hzï¼Œå¼€å‘äº†äº‘å¹³å°ï¼Œè¿˜æ˜¯å¾ˆä¸é”™æ»´æ‹‰ã€‚ï¼","categories":[{"name":"ç”Ÿæ´»æ—¥å¸¸","slug":"ç”Ÿæ´»æ—¥å¸¸","permalink":"http://he49816306.github.io/categories/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"}],"tags":[{"name":"é—²èŠ","slug":"é—²èŠ","permalink":"http://he49816306.github.io/tags/%E9%97%B2%E8%81%8A/"}]},{"title":"åå¤§ç»å…¸æ’åºç®—æ³•æ•´ç†æ±‡æ€»ï¼ˆé™„ä»£ç ï¼‰","slug":"sort-algorithms","date":"2020-02-16T07:09:23.000Z","updated":"2020-06-18T09:13:57.998Z","comments":true,"path":"2020/02/16/sort-algorithms/","link":"","permalink":"http://he49816306.github.io/2020/02/16/sort-algorithms/","excerpt":"","text":"ç»å¸¸å³å°†å¼€å§‹ï¼ï¼ï¼ å‰è¨€æœ¬æ–‡æ•´ç†å¹¶æ€»ç»“äº†åå¤§ç»å…¸çš„æ’åºç®—æ³•ï¼ˆå†’æ³¡æ’åºã€é€‰æ‹©æ’åºã€æ’å…¥æ’åºã€å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å¸Œå°”æ’åºã€è®¡æ•°æ’åºã€åŸºæ•°æ’åºã€æ¡¶æ’åºã€å †æ’åºï¼‰çš„æ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦ç­‰æ€§è´¨ã€‚ æœ¬æ–‡å¹¶ä¸ä¼šè¯¦ç»†è®²è§£æ¯ç§æ’åºç®—æ³•çš„åŸç†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå¾ˆå¥½çš„æ•™ç¨‹ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å»æœäº†çœ‹ã€‚ æœ€åæˆ‘è¿˜äº²è‡ªæ‰‹å†™äº†åç§æ’åºç®—æ³•çš„ c++ ä»£ç ï¼Œå¤§å®¶å¯ä»¥ç”¨æ¥é€šè¿‡ LeetCode 912. æ’åºæ•°ç»„ è¿™é“é¢˜ã€‚ æ€§è´¨æ±‡æ€» å¦‚æœå‘ç°è¡¨ä¸­æœ‰é”™è¯¯ï¼Œè¯·ç•™è¨€å‘ŠçŸ¥ã€‚ ç®—æ³• æœ€å¥½ æœ€å å¹³å‡ ç©ºé—´ ç¨³å®šæ€§ æ˜¯å¦åŸºäºæ¯”è¾ƒ å†’æ³¡æ’åº $O(n)$ $O(n^2)$ $O(n^2)$ $O(1)$ $\\checkmark$ $\\checkmark$ é€‰æ‹©æ’åº $O(n^2)$ $O(n^2)$ $O(n^2)$ $O(1)$ $\\times$ $\\checkmark$ æ’å…¥æ’åº $O(n)$ $O(n^2)$ $O(n^2)$ $O(1)$ $\\checkmark$ $\\checkmark$ å¿«é€Ÿæ’åº $O(n\\log n)$ $O(n^2)$ $O(n\\log n)$ $O(\\log n)$~$O(n)$ $\\times$ $\\checkmark$ å½’å¹¶æ’åº $O(n\\log n)$ $O(n\\log n)$ $O(n\\log n)$ $O(n)$ $\\checkmark$ $\\checkmark$ å¸Œå°”æ’åº $O(n^{1.3})$ $O(n^2)$ $O(n\\log n)$~$O(n^2)$ $O(1)$ $\\times$ $\\checkmark$ è®¡æ•°æ’åº $O(n+k)$ $O(n+k)$ $O(n+k)$ $O(n+k)$ $\\checkmark$ $\\times$ åŸºæ•°æ’åº $O(nk)$ $O(nk)$ $O(nk)$ $O(n+k)$ $\\checkmark$ $\\times$ æ¡¶æ’åº $O(n)$ $O(n)$ $O(n)$ $O(n+m)$ $\\checkmark$ $\\times$ å †æ’åº $O(n\\log n)$ $O(n\\log n)$ $O(n\\log n)$ $O(1)$ $\\times$ $\\checkmark$ å¦‚æœè¡¨æ ¼æ˜¾ç¤ºæœ‰é—®é¢˜çš„è¯ï¼Œè¿˜å¯ä»¥ç›´æ¥çœ‹ä¸‹é¢çš„æ±‡æ€»å›¾ï¼š ç»´åŸºç™¾ç§‘æˆ‘è§‰å¾—è¿˜æ˜¯è‹±æ–‡ç»´åŸºç™¾ç§‘è®²çš„æ¯”è¾ƒè¯¦ç»†ã€ä¸¥è°¨ã€‚å¦‚æœå¤§å®¶çœ‹çš„æ¯”è¾ƒç´¯çš„è¯ï¼Œå¯ä»¥è‡ªå·±ç™¾åº¦æœç´¢ç›¸åº”çš„æ•™ç¨‹ã€‚ å†’æ³¡æ’åºhttps://en.wikipedia.org/wiki/Bubble_sort é€‰æ‹©æ’åºhttps://en.wikipedia.org/wiki/Selection_sort æ’å…¥æ’åºhttps://en.wikipedia.org/wiki/Insertion_sort å¿«é€Ÿæ’åºhttps://en.wikipedia.org/wiki/Quicksort å½’å¹¶æ’åºhttps://en.wikipedia.org/wiki/Merge_sort å¸Œå°”æ’åºhttps://en.wikipedia.org/wiki/Shellsort è®¡æ•°æ’åºhttps://en.wikipedia.org/wiki/Counting_sort åŸºæ•°æ’åºhttps://en.wikipedia.org/wiki/Radix_sort æ¡¶æ’åºhttps://en.wikipedia.org/wiki/Bucket_sort å †æ’åºhttps://en.wikipedia.org/wiki/Heapsort ä»£ç å®ç°æ‰€æœ‰çš„æ’åºç®—æ³•æ¥å£éƒ½æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯ vector&lt;int&gt; xxxSort(vector&lt;int&gt;&amp; nums) ã€‚åªéœ€è¦ä½ ä¼ å…¥ä¸€ä¸ª vector&lt;int&gt; ç±»å‹çš„æ•°ç»„ï¼Œå°±èƒ½è¿”å›æ’åºåçš„ç»“æœã€‚ è¿è¡Œä¸‹æ¥å¯ä»¥å‘ç°ï¼Œæ¡¶æ’åºé€Ÿåº¦æ˜¯æ¯”è¾ƒå¿«çš„ã€‚è€Œå†’æ³¡æ’åºã€é€‰æ‹©æ’åºå’Œæ’å…¥æ’åºå› ä¸ºæ—¶é—´å¤æ‚åº¦å¤ªé«˜æ— æ³•é€šè¿‡æœ¬é¢˜ï¼ŒåŸºæ•°æ’åºå› ä¸ºæ— æ³•å¤„ç†è´Ÿæ•°ä¹Ÿä¸èƒ½é€šè¿‡æœ¬é¢˜ã€‚ class Solution { public: vector&lt;int&gt; sortArray(vector&lt;int&gt;&amp; nums) { return quickSort(nums); } // å†’æ³¡æ’åºï¼ˆè¶…æ—¶ï¼‰ vector&lt;int&gt; bubbleSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); for (int i = 0; i &lt; n; ++i) { for (int j = n-2; j &gt;= i; --j) { if (nums[j] &gt; nums[j+1]) { swap(nums[j], nums[j+1]); } } } return nums; } // é€‰æ‹©æ’åºï¼ˆè¶…æ—¶ï¼‰ vector&lt;int&gt; selectSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); for (int i = 0; i &lt; n; ++i) { int idx = i; for (int j = i; j &lt; n; ++j) { if (nums[j] &lt; nums[idx]) { idx = j; } } swap(nums[i], nums[idx]); } return nums; } // æ’å…¥æ’åºï¼ˆè¶…æ—¶ï¼‰ vector&lt;int&gt; insertSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); for (int i = 0; i &lt; n; ++i) { for (int j = i; j &gt; 0 &amp;&amp; nums[j] &lt; nums[j-1]; --j) { swap(nums[j], nums[j-1]); } } return nums; } // å¿«é€Ÿæ’åºï¼ˆ24 msï¼‰ void qSort(vector&lt;int&gt;&amp; nums, int l, int r) { if (l &gt;= r) return; int m = l; for (int i = l; i &lt; r; ++i) { if (nums[i] &lt; nums[r]) { swap(nums[m++], nums[i]); } } swap(nums[m], nums[r]); qSort(nums, l, m-1); qSort(nums, m+1, r); } vector&lt;int&gt; quickSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); qSort(nums, 0, n-1); return nums; } // å½’å¹¶æ’åºï¼ˆ192 msï¼‰ vector&lt;int&gt; mSort(vector&lt;int&gt;&amp; nums, int l, int r) { if (l &gt;= r) return {nums[l]}; int m = l+(r-l)/2; vector&lt;int&gt; lnums = mSort(nums, l, m); vector&lt;int&gt; rnums = mSort(nums, m+1, r); vector&lt;int&gt; res; int i = 0, j = 0; while (i &lt;= m-l &amp;&amp; j &lt;= r-m-1) { if (lnums[i] &lt; rnums[j]) { res.push_back(lnums[i++]); } else { res.push_back(rnums[j++]); } } while (i &lt;= m-l) { res.push_back(lnums[i++]); } while (j &lt;= r-m-1) { res.push_back(rnums[j++]); } return res; } vector&lt;int&gt; mergeSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); nums = mSort(nums, 0, n-1); return nums; } // å½’å¹¶æ’åº + éé€’å½’ï¼ˆ80 msï¼‰ vector&lt;int&gt; mergeSortNR(vector&lt;int&gt;&amp; nums) { int n = nums.size(); for (int len = 1; len &lt; n; len &lt;&lt;= 1) { for (int l = 0; l &lt; n-len; l += 2*len) { int m = l+len-1; int r = min(n-1, l+2*len-1); vector&lt;int&gt; res; int i = l, j = m+1; while (i &lt;= m &amp;&amp; j &lt;= r) { if (nums[i] &lt; nums[j]) { res.push_back(nums[i++]); } else { res.push_back(nums[j++]); } } while (i &lt;= m) { res.push_back(nums[i++]); } while (j &lt;= r) { res.push_back(nums[j++]); } for (int i = l; i &lt;= r; ++i) { nums[i] = res[i-l]; } } } return nums; } // å¸Œå°”æ’åºï¼ˆ40 msï¼‰ vector&lt;int&gt; shellSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); for (int gap = n/2; gap &gt; 0; gap /= 2) { for (int i = gap; i &lt; n; ++i) { for (int j = i; j-gap &gt;= 0 &amp;&amp; nums[j-gap] &gt; nums[j]; j -= gap) { swap(nums[j-gap], nums[j]); } } } return nums; } // è®¡æ•°æ’åºï¼ˆ32 msï¼‰ vector&lt;int&gt; countSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); if (!n) return {}; int minv = *min_element(nums.begin(), nums.end()); int maxv = *max_element(nums.begin(), nums.end()); int m = maxv-minv+1; vector&lt;int&gt; count(m, 0); for (int i = 0; i &lt; n; ++i) { count[nums[i]-minv]++; } vector&lt;int&gt; res; for (int i = 0; i &lt; m; ++i) { for (int j = 0; j &lt; count[i]; ++j) { res.push_back(i+minv); } } return res; } // åŸºæ•°æ’åºï¼ˆä¸é€‚ç”¨äºè´Ÿæ•°ï¼‰ vector&lt;int&gt; radixSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); int maxv = *max_element(nums.begin(), nums.end()); int maxd = 0; while (maxv &gt; 0) { maxv /= 10; maxd++; } vector&lt;int&gt; count(10, 0), rank(n, 0); int base = 1; while (maxd &gt; 0) { count.assign(10, 0); for (int i = 0; i &lt; n; ++i) { count[(nums[i]/base)%10]++; } for (int i = 1; i &lt; 10; ++i) { count[i] += count[i-1]; } for (int i = n-1; i &gt;= 0; --i) { rank[--count[(nums[i]/base)%10]] = nums[i]; } for (int i = 0; i &lt; n; ++i) { nums[i] = rank[i]; } maxd--; base *= 10; } return nums; } // æ¡¶æ’åº (20 ms) vector&lt;int&gt; bucketSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); int maxv = *max_element(nums.begin(), nums.end()); int minv = *min_element(nums.begin(), nums.end()); int bs = 1000; int m = (maxv-minv)/bs+1; vector&lt;vector&lt;int&gt; &gt; bucket(m); for (int i = 0; i &lt; n; ++i) { bucket[(nums[i]-minv)/bs].push_back(nums[i]); } int idx = 0; for (int i = 0; i &lt; m; ++i) { int sz = bucket[i].size(); bucket[i] = quickSort(bucket[i]); for (int j = 0; j &lt; sz; ++j) { nums[idx++] = bucket[i][j]; } } return nums; } // å †æ’åºï¼ˆ32 msï¼‰ void adjust(vector&lt;int&gt;&amp; nums, int p, int s) { while (2*p+1 &lt; s) { int c1 = 2*p+1; int c2 = 2*p+2; int c = (c2&lt;s &amp;&amp; nums[c2]&gt;nums[c1]) ? c2 : c1; if (nums[c] &gt; nums[p]) swap(nums[c], nums[p]); else break; p = c; } } vector&lt;int&gt; heapSort(vector&lt;int&gt;&amp; nums) { int n = nums.size(); for (int i = n/2-1; i &gt;= 0; --i) { adjust(nums, i, n); } for (int i = n-1; i &gt; 0; --i) { swap(nums[0], nums[i]); adjust(nums, 0, i); } return nums; } };","categories":[{"name":"ç¼–ç¨‹ç®—æ³•","slug":"ç¼–ç¨‹ç®—æ³•","permalink":"http://he49816306.github.io/categories/%E7%BC%96%E7%A8%8B%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://he49816306.github.io/tags/leetcode/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://he49816306.github.io/tags/%E7%AE%97%E6%B3%95/"}]},{"title":"Hello World","slug":"hello-world","date":"2020-02-15T07:09:23.000Z","updated":"2021-01-07T06:23:35.591Z","comments":true,"path":"2020/02/15/hello-world/","link":"","permalink":"http://he49816306.github.io/2020/02/15/hello-world/","excerpt":"","text":"Welcome to blog! This is your very first post. Check documentation for more info. If you get any problems when using blog, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new &quot;My New Post&quot; More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment","categories":[{"name":"ç¼–ç¨‹ç®—æ³•","slug":"ç¼–ç¨‹ç®—æ³•","permalink":"http://he49816306.github.io/categories/%E7%BC%96%E7%A8%8B%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://he49816306.github.io/tags/leetcode/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://he49816306.github.io/tags/%E7%AE%97%E6%B3%95/"}]}],"categories":[{"name":"å¹¶å‘æ“ä½œ","slug":"å¹¶å‘æ“ä½œ","permalink":"http://he49816306.github.io/categories/%E5%B9%B6%E5%8F%91%E6%93%8D%E4%BD%9C/"},{"name":"æŠ€æœ¯åŸç†","slug":"æŠ€æœ¯åŸç†","permalink":"http://he49816306.github.io/categories/%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/"},{"name":"ç”Ÿæ´»æ—¥å¸¸","slug":"ç”Ÿæ´»æ—¥å¸¸","permalink":"http://he49816306.github.io/categories/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"},{"name":"ç¼–ç¨‹ç®—æ³•","slug":"ç¼–ç¨‹ç®—æ³•","permalink":"http://he49816306.github.io/categories/%E7%BC%96%E7%A8%8B%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"http://he49816306.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"},{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"http://he49816306.github.io/tags/%E4%BC%98%E5%8C%96/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","permalink":"http://he49816306.github.io/tags/%E5%B9%B6%E5%8F%91/"},{"name":"åŸç†","slug":"åŸç†","permalink":"http://he49816306.github.io/tags/%E5%8E%9F%E7%90%86/"},{"name":"æºç ","slug":"æºç ","permalink":"http://he49816306.github.io/tags/%E6%BA%90%E7%A0%81/"},{"name":"é—²èŠ","slug":"é—²èŠ","permalink":"http://he49816306.github.io/tags/%E9%97%B2%E8%81%8A/"},{"name":"leetcode","slug":"leetcode","permalink":"http://he49816306.github.io/tags/leetcode/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://he49816306.github.io/tags/%E7%AE%97%E6%B3%95/"}]}